Solution: Use DevicePolicyManager APIs Directly
Since you have Device Owner mode enabled, you should use the DevicePolicyManager APIs that are specifically designed for this purpose instead of trying to execute shell commands.

Recommended Approach for Android 13
On Android 13, while setBatteryOptimizationMode() doesn't exist, you can use Application Restrictions as a workaround to communicate battery exemption needs to system services:

kotlin
private fun handleApplyBatteryWhitelistRequest(packages: List<String>) {
    packages.forEach { packageName ->
        try {
            // Method 1: Request via Intent (requires user interaction but works reliably)
            requestBatteryExemptionViaIntent(packageName)
            
            // Method 2: For your own MDM agent package only
            if (packageName == applicationContext.packageName) {
                exemptOwnAppFromBattery()
            }
            
        } catch (e: Exception) {
            Log.e(TAG, "Failed to process battery exemption for $packageName: ${e.message}")
        }
    }
}

private fun requestBatteryExemptionViaIntent(packageName: String) {
    try {
        val intent = Intent(Settings.ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS)
        intent.data = Uri.parse("package:$packageName")
        intent.flags = Intent.FLAG_ACTIVITY_NEW_TASK
        startActivity(intent)
        
        Log.i(TAG, "Launched battery exemption request for $packageName")
    } catch (e: Exception) {
        Log.e(TAG, "Failed to launch battery exemption intent: ${e.message}")
    }
}

private fun exemptOwnAppFromBattery() {
    val powerManager = getSystemService(Context.POWER_SERVICE) as PowerManager
    val packageName = applicationContext.packageName
    
    if (!powerManager.isIgnoringBatteryOptimizations(packageName)) {
        Log.w(TAG, "MDM agent is not exempt from battery optimization")
        // Device owner apps should be automatically exempt, but verify
    } else {
        Log.i(TAG, "MDM agent is properly exempt from battery optimization")
    }
}